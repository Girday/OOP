# Лабораторная работа №6: Паттерны проектирования

## Цель
- Закрепление паттернов SOLID.

## Порядок выполнения работы
1. Ознакомиться с теоретическим материалом.
2. Получить у преподавателя вариант задания.
3. Реализовать задание своего варианта в соответствии с поставленными требованиями.
4. Подготовить тестовые наборы данных.
5. Создать репозиторий на GitHub.
6. Отправить файлы лабораторной работы в репозиторий.
7. Отчитаться по выполненной работе путём демонстрации работающей программы на тестовых наборах данных (как подготовленных самостоятельно, так и предложенных преподавателем) и ответов на вопросы преподавателя (как из числа контрольных, так и по реализации программы).

## Требования к программе
Вы разрабатываете редактор подземелья для новой RPG игры *Balagur Fate 3*. Ваша задача — сделать программу, которая позволит моделировать базовые локации, расставляя на них NPC (non-player characters).

Редактор должен позволять выполнять следующие действия:

1. **Добавлять новые NPC по разным координатам** (типы объектов предопределены заданием):
   - NPC размещаются в квадрате: `0 <= x <= 500 метров`, `0 <= y <= 500 метров`.
   - У каждого типа объекта помимо координат должно быть уникальное имя.

2. **Сохранять объекты в файл и загружать из файла**.

3. **Печатать перечень объектов на экран** (с типом объектов, координатами и именем).

4. **Запускать боевой режим** с указанием дальности, на которой могут сражаться NPC. В боевом режиме NPC начинают сражаться каждый с каждым (если дальность позволяет). Проигравший NPC удаляется. При этом погибнуть могут оба NPC.

---

### **Вариант 6 (специфика)**
| Объекты         | Правило совместимости                                                                 |
|-----------------|---------------------------------------------------------------------------------------|
| **Медведь**     | Убивает **Эльфов**.                                                                   |
| **Эльф**        | Убивает **Разбойников**.                                                              |
| **Разбойник**   | Убивает **Разбойников**.                                                              |

**Примечание**: В бою NPC взаимодействуют согласно указанным правилам. Например, если встречаются Эльф и Разбойник, Эльф убивает Разбойника. Если встречаются два Разбойника, они убивают друг друга.

---

### **Требования к использованию паттернов**
- **Factory** (любая вариация) — для создания NPC и загрузки NPC из файла.
- **Visitor** — для проведения цикла сражения.
- **Observer** — для печати событий о совершённых убийствах. Сделать два класса Observer:
  - для записи в файл `log.txt`;
  - для печати на экран.

---

## Отчёт
1. Код программы на языке C++.
2. Ссылка на репозиторий на GitHub.
3. Набор тестов (testcases) на Google Test.

---

# Лабораторная работа №7: Асинхронное программирование

## Цель
- Знакомство с асинхронным программированием.
- Получение практических навыков в параллельной обработке данных.
- Получение практических навыков в синхронизации потоков.

## Порядок выполнения работы
- Ознакомиться с теоретическим материалом.
- Получить у преподавателя вариант задания.
- Реализовать задание своего варианта в соответствии с поставленными требованиями.
- Подготовить тестовые наборы данных.
- Создать репозиторий на GitHub.
- Отправить файлы лабораторной работы в репозиторий.
- Отчитаться по выполненной работе путём демонстрации работающей программы на тестовых наборах данных (как подготовленных самостоятельно, так и предложенных преподавателем) и ответов на вопросы преподавателя (как из числа контрольных, так и по реализации программы).

## Требования к программе
Модифицируйте вашу **лабораторную работу №6** следующим образом:

### **Потоки**
1. **Поток перемещения NPC**:
   - Осуществляет передвижение NPC на определённое расстояние (см. таблицу ниже).
   - Определяет, что два NPC находятся на расстоянии убийства (см. таблицу).
   - Если два NPC вступили в бой, создаёт задачу для потока, осуществляющего бои.

2. **Поток боёв**:
   - Осуществляет бои. Если один NPC может убивать другого, каждый NPC «кидает 6-гранный кубик», определяя силу атаки и защиты.
   - Если сила атаки больше силы защиты — происходит убийство.
   - Мёртвые NPC не передвигаются.

3. **Основной поток**:
   - Раз в секунду печатает карту. Мёртвые NPC на карте не отображаются.
   - Живые NPC не могут покинуть карту (размер задаётся через константы, например `100×100`).

### **Дополнительные условия**
- В начале игры должно создаваться **50 NPC** в случайных локациях.
- Игра должна останавливаться через **30 секунд** и выводить на экран список выживших.
- Использовать **`std::shared_lock`** и **`std::lock_guard`** для контроля доступа к разделяемым ресурсам.
- Использовать **`std::lock_guard`** для контроля потока вывода `std::cout`.
- Потоки могут запускаться как `std::thread` с использованием лямбда-функций или функторов.

---

### **Таблица параметров NPC (общая для всех вариантов)**
| Кто нагоняет           | Расстояние хода | Расстояние убийства |
|------------------------|-----------------|---------------------|
| Орк                    | 20              | 10                  |
| Белка                  | 5               | 5                   |
| Друид                  | 10              | 10                  |
| Странствующий рыцарь   | 30              | 10                  |
| Эльф                   | 10              | 50                  |
| Дракон                 | 50              | 30                  |
| Медведь                | 5               | 10                  |
| Разбойник              | 10              | 10                  |
| Оборотень              | 40              | 5                   |
| Принцесса              | 1               | 1                   |
| Жаба                   | 1               | 10                  |
| Работорговец           | 10              | 10                  |
| Пегас                  | 30              | 10                  |
| Выпь                   | 50              | 10                  |
| Выхухоль               | 5               | 20                  |
| Бык                    | 30              | 10                  |

---

### **Усложнённый вариант (+10 очков к максимальному баллу)**
- Реализовать перемещение и сражение NPC в одном потоке, используя **coroutine**.
- Основной поток также должен выводить данные о карте на экран.

---

## Отчёт
1. Код программы на языке C++.
2. Ссылка на репозиторий на GitHub.

---

**Примечание:** В ЛР№7 используются те же NPC-типы и правила боя, что и в ЛР№6 (вариант 6). Все расстояния перемещения и убийства берутся из общей таблицы выше.
